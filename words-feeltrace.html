
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Feeltrace and calibrated words analysis &#8212; Emotion Transitions Analysis</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >let toggleHintShow = 'Click to show';</script>
    <script >let toggleHintHide = 'Click to hide';</script>
    <script >let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script >const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Calibrated words self-report analysis" href="calibrated-words.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Emotion Transitions Analysis</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Intro
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="feeltrace.html">
   Continuous self-report analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="calibrated-words.html">
   Calibrated words self-report analysis
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Feeltrace and calibrated words analysis
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/words-feeltrace.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fwords-feeltrace.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/words-feeltrace.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-definitions">
   Module definitions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-data">
   Import data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scratchpad">
   Scratchpad
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#downsampling-the-continuous-annotation">
     Downsampling the continuous annotation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#aggregating-by-taking-the-mean">
       Aggregating by taking the mean
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#aggregating-by-taking-the-slope">
       Aggregating by taking the slope
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#joint-time-series-analysis">
       Joint time series analysis
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#limitations">
       Limitations
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#emotion-dynamics-analysis">
   Emotion dynamics analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#defining-emotion-dynamics-features">
     Defining emotion dynamics features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-preprocessing-scaling">
     Data preprocessing: scaling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pairplot-analysis">
     Pairplot analysis
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#d-scatterplot">
     3D scatterplot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#principal-component-analysis">
     Principal Component Analysis
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gaussian-mixture-model">
     Gaussian Mixture Model
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="feeltrace-and-calibrated-words-analysis">
<h1>Feeltrace and calibrated words analysis<a class="headerlink" href="#feeltrace-and-calibrated-words-analysis" title="Permalink to this headline">¶</a></h1>
<p>Rubia Guerra</p>
<p>Last updated: Apr 14th 2022</p>
<div class="section" id="module-definitions">
<h2>Module definitions<a class="headerlink" href="#module-definitions" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy.io</span> <span class="k">as</span> <span class="nn">sio</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa</span> <span class="kn">import</span> <span class="n">stattools</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">ConfusionMatrixDisplay</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_recall_fscore_support</span>

<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;seaborn&quot;</span><span class="p">)</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="import-data">
<h2>Import data<a class="headerlink" href="#import-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">load_dataset</span><span class="p">(</span><span class="n">data_dir</span> <span class="o">=</span> <span class="s1">&#39;../EEG/data/p*&#39;</span><span class="p">):</span>
    <span class="n">feeltrace_data_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;joystick.mat&#39;</span><span class="p">))</span>
    <span class="n">feeltrace_data_files</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    
    <span class="n">feeltrace_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">subject_filename</span> <span class="ow">in</span> <span class="n">feeltrace_data_files</span><span class="p">:</span>
        <span class="n">mat_contents</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">subject_filename</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">mat_contents</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">,</span> <span class="s1">&#39;Feeltrace&#39;</span><span class="p">])</span>
        <span class="n">p_number</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;p\d+&#39;</span><span class="p">,</span> <span class="n">subject_filename</span><span class="p">)</span> <span class="o">*</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_number</span>
        <span class="n">feeltrace_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    
    <span class="n">subject_data_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;calibrated_words_calibrated_values.mat&#39;</span><span class="p">))</span>
    <span class="n">subject_data_files</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="n">timestamps_data_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;calibrated_words_time*.mat&#39;</span><span class="p">))</span>
    <span class="n">timestamps_data_files</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    
    <span class="n">subjects_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">subject_filename</span><span class="p">,</span> <span class="n">timestamp_filename</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">subject_data_files</span><span class="p">,</span> <span class="n">timestamps_data_files</span><span class="p">):</span>
        <span class="n">subject_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">sio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">subject_filename</span><span class="p">)[</span><span class="s1">&#39;var&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span>
        <span class="n">timestamp_data</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">timestamp_filename</span><span class="p">)[</span><span class="s1">&#39;var&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

        <span class="n">df_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">timestamp_data</span><span class="p">,</span> <span class="n">subject_data</span><span class="p">))</span>        
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">,</span> <span class="s1">&#39;Values&#39;</span><span class="p">])</span>

        <span class="n">p_number</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;p\d+&#39;</span><span class="p">,</span> <span class="n">subject_filename</span><span class="p">)</span> <span class="o">*</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;p_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_number</span>
        <span class="n">subjects_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">subjects_data</span><span class="p">,</span> <span class="n">feeltrace_data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">words_list</span><span class="p">,</span> <span class="n">feeltrace_list</span><span class="p">]</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">words_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">words_list</span><span class="p">)</span>
<span class="n">feeltrace_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">feeltrace_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">feeltrace_df</span><span class="o">.</span><span class="n">p_number</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;p10&#39;, &#39;p12&#39;, &#39;p13&#39;, &#39;p15&#39;, &#39;p17&#39;, &#39;p19&#39;, &#39;p2&#39;, &#39;p20&#39;, &#39;p22&#39;,
       &#39;p23&#39;, &#39;p4&#39;, &#39;p5&#39;, &#39;p6&#39;, &#39;p7&#39;, &#39;p8&#39;, &#39;p9&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">words_list</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamps</th>
      <th>Values</th>
      <th>p_number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>41100</td>
      <td>100.0</td>
      <td>p10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>66900</td>
      <td>110.0</td>
      <td>p10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>86833</td>
      <td>185.0</td>
      <td>p10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>109466</td>
      <td>185.0</td>
      <td>p10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>152233</td>
      <td>115.0</td>
      <td>p10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">feeltrace_list</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamps</th>
      <th>Feeltrace</th>
      <th>p_number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9437.0</td>
      <td>74.0</td>
      <td>p10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9451.0</td>
      <td>74.0</td>
      <td>p10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9471.0</td>
      <td>74.0</td>
      <td>p10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9511.0</td>
      <td>75.0</td>
      <td>p10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9548.0</td>
      <td>74.0</td>
      <td>p10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="scratchpad">
<h2>Scratchpad<a class="headerlink" href="#scratchpad" title="Permalink to this headline">¶</a></h2>
<p>Testing code with a single subject</p>
<div class="section" id="downsampling-the-continuous-annotation">
<h3>Downsampling the continuous annotation<a class="headerlink" href="#downsampling-the-continuous-annotation" title="Permalink to this headline">¶</a></h3>
<p>Before time series analysis can be performed, we must downsample the feeltrace to match the sample size of the interview words (or upsample the interview words):</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\text{Fs}_{\text{feeltrace}} = 30\)</span>Hz</p></li>
<li><p><span class="math notranslate nohighlight">\(\text{Fs}_{\text{calibrated words}} \approx 0.05\)</span>Hz</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">min_</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_</span><span class="o">=</span><span class="mi">200</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">min_</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">max_</span> <span class="o">-</span> <span class="n">min_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p10_words</span> <span class="o">=</span> <span class="n">words_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">p10_feeltrace</span> <span class="o">=</span> <span class="n">feeltrace_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">p10_words</span><span class="o">.</span><span class="n">Values</span> <span class="o">=</span> <span class="n">scale</span><span class="p">(</span><span class="n">p10_words</span><span class="o">.</span><span class="n">Values</span><span class="p">)</span>
<span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">Feeltrace</span> <span class="o">=</span> <span class="n">scale</span><span class="p">(</span><span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">Feeltrace</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p10_words</span><span class="o">.</span><span class="n">Timestamps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="n">p10_words</span><span class="o">.</span><span class="n">Timestamps</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.040934900303710546
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">Timestamps</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">Timestamps</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>29.64152332829802
</pre></div>
</div>
</div>
</div>
<p>Here, I attempt downsampling the feeltrace using aggregation strategies. I am using windows corresponding to midpoints in between sampled words. For instance, if the first interview word is recorded at <span class="math notranslate nohighlight">\(t=10\)</span>s and the next word is recorded at <span class="math notranslate nohighlight">\(t=15\)</span>s, the first window corresponds to <span class="math notranslate nohighlight">\(t=0\)</span>s to <span class="math notranslate nohighlight">\(t=12.5\)</span>s.</p>
<p>We can calculate windows using a rolling average on the interview timestamps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timestamps</span> <span class="o">=</span> <span class="n">p10_words</span><span class="o">.</span><span class="n">Timestamps</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">timestamps</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     54000.0
1     76866.5
2     98149.5
3    130849.5
4    158899.5
Name: Timestamps, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">p10_words</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">timestamps</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/words-feeltrace_19_0.png" src="_images/words-feeltrace_19_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">p10_feeltrace</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Feeltrace&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">timestamps</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/words-feeltrace_20_0.png" src="_images/words-feeltrace_20_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">p10_words</span><span class="p">[</span><span class="s1">&#39;Values&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p10_words</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/words-feeltrace_21_0.png" src="_images/words-feeltrace_21_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">p10_feeltrace</span><span class="p">[</span><span class="s1">&#39;Feeltrace&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p10_feeltrace</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/words-feeltrace_22_0.png" src="_images/words-feeltrace_22_0.png" />
</div>
</div>
<p>Extract indexes in the feeltrace by looking at the nearest timestamp that matches our window start points:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idxs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">timestamp</span> <span class="ow">in</span> <span class="n">timestamps</span><span class="p">:</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">Timestamps</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr</span> <span class="o">-</span> <span class="n">timestamp</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">dist</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dist</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">idxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Indexes: %s&#39;</span> <span class="o">%</span> <span class="n">idxs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Indexes: [1331, 2024, 2641, 3629, 4477, 5016, 6008, 6779, 7638, 8859, 9432, 9794, 10266, 10732, 11658, 12617, 13246, 13851, 14264, 14702, 15357, 15873, 16053, 16588, 17221, 18343, 19784, 20457, 21141, 21975]
</pre></div>
</div>
</div>
</div>
<p>Timestamps for the new feeltrace are defined as the mean timestamp of the window ((window start + window end) / 2):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">feeltrace_timestamps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">,</span> <span class="s1">&#39;Timestamps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="c1"># add first timestamp</span>
<span class="n">feeltrace_timestamps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Timestamps&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>

<span class="c1"># add last timestamp</span>
<span class="n">feeltrace_timestamps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">Timestamps</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Timestamps&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">feeltrace_timestamps</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">feeltrace_timestamps</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Timestamps (ms): %s&#39;</span> <span class="o">%</span> <span class="n">feeltrace_timestamps</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamps (ms): 0     26996.0
1     65427.0
2     87506.5
3    114499.5
4    144872.5
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make sure both series are the same length</span>
<span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">feeltrace_timestamps</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">p10_words</span><span class="o">.</span><span class="n">Timestamps</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Now, I explore aggregating the feeltrace in two ways:</p>
<ul class="simple">
<li><p>By taking the mean value of all points in window</p></li>
<li><p>By calculating the overall direction of change in the feeltrace (slope)</p></li>
</ul>
<div class="section" id="aggregating-by-taking-the-mean">
<h4>Aggregating by taking the mean<a class="headerlink" href="#aggregating-by-taking-the-mean" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p10_feeltrace_agg_mean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">mean_feeltrace</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># first window</span>
<span class="n">mean_feeltrace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">Feeltrace</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="c1"># middle windows</span>
<span class="k">for</span> <span class="p">(</span><span class="n">prev_idx</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">idxs</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">idxs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">mean_feeltrace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">Feeltrace</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">prev_idx</span><span class="p">:</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="c1"># last window</span>
<span class="n">mean_feeltrace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">Feeltrace</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="c1"># make sure both feeltrace and interview series are the same size</span>
<span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mean_feeltrace</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">p10_words</span><span class="o">.</span><span class="n">Values</span><span class="p">))</span>

<span class="n">p10_feeltrace_agg_mean</span><span class="p">[</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">feeltrace_timestamps</span>
<span class="n">p10_feeltrace_agg_mean</span><span class="p">[</span><span class="s1">&#39;Feeltrace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_feeltrace</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p10_feeltrace_agg_mean</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamps</th>
      <th>Feeltrace</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>26996.0</td>
      <td>0.372654</td>
    </tr>
    <tr>
      <th>1</th>
      <td>65427.0</td>
      <td>0.413613</td>
    </tr>
    <tr>
      <th>2</th>
      <td>87506.5</td>
      <td>0.490906</td>
    </tr>
    <tr>
      <th>3</th>
      <td>114499.5</td>
      <td>0.552672</td>
    </tr>
    <tr>
      <th>4</th>
      <td>144872.5</td>
      <td>0.375592</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">p10_feeltrace</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Feeltrace&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">p10_feeltrace_agg_mean</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Feeltrace&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">p10_words</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Values&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Original feeltrace&#39;</span><span class="p">,</span> <span class="s1">&#39;AggFeeltrace&#39;</span><span class="p">,</span> <span class="s1">&#39;Words&#39;</span><span class="p">]);</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">timestamps</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/words-feeltrace_32_0.png" src="_images/words-feeltrace_32_0.png" />
</div>
</div>
<p>Checking autocorelation on aggregated data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">p10_feeltrace_agg_mean</span><span class="p">[</span><span class="s1">&#39;Feeltrace&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p10_feeltrace_agg_mean</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/words-feeltrace_34_0.png" src="_images/words-feeltrace_34_0.png" />
</div>
</div>
</div>
<div class="section" id="aggregating-by-taking-the-slope">
<h4>Aggregating by taking the slope<a class="headerlink" href="#aggregating-by-taking-the-slope" title="Permalink to this headline">¶</a></h4>
<p>Trying to bin state transitions in three values:</p>
<ul class="simple">
<li><p>Increase in stress level (+1)</p></li>
<li><p>Neutral (0)</p></li>
<li><p>Decrease in stress level (-1)</p></li>
</ul>
<p>Tried a few attemps, settling for taking first and last value of window:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">change_direction</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">slope</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">slope</span>
       
    <span class="k">def</span> <span class="nf">slope_angle</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">angle</span>
    
    <span class="k">def</span> <span class="nf">slope_sign</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">1e3</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">slope</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">factor</span><span class="p">):</span> 
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">slope</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">factor</span><span class="p">)</span> 
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">return</span> <span class="mi">0</span>
        
    <span class="k">def</span> <span class="nf">first_last</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">diff</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
       
    <span class="k">return</span> <span class="n">first_last</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Calculating for feeltrace:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p10_feeltrace_agg_slope</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">slope_feeltrace</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># first window</span>
<span class="n">slope_feeltrace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">change_direction</span><span class="p">(</span><span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">Feeltrace</span><span class="p">[:</span><span class="n">idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">Timestamps</span><span class="p">[:</span><span class="n">idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>

<span class="c1"># middle windows</span>
<span class="k">for</span> <span class="p">(</span><span class="n">prev_idx</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">idxs</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">idxs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">slope_feeltrace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">change_direction</span><span class="p">(</span><span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">Feeltrace</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">prev_idx</span><span class="p">:</span><span class="n">idx</span><span class="p">],</span> <span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">Timestamps</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">prev_idx</span><span class="p">:</span><span class="n">idx</span><span class="p">]))</span>

<span class="c1"># last window</span>
<span class="n">slope_feeltrace</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">change_direction</span><span class="p">(</span><span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">Feeltrace</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:],</span> <span class="n">p10_feeltrace</span><span class="o">.</span><span class="n">Timestamps</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idxs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:]))</span>

<span class="c1"># make sure both feeltrace and interview series are the same size</span>
<span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">slope_feeltrace</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">p10_words</span><span class="o">.</span><span class="n">Values</span><span class="p">))</span>

<span class="n">p10_feeltrace_agg_slope</span><span class="p">[</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">feeltrace_timestamps</span>
<span class="n">p10_feeltrace_agg_slope</span><span class="p">[</span><span class="s1">&#39;Feeltrace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">slope_feeltrace</span>
<span class="n">p10_feeltrace_agg_slope</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamps</th>
      <th>Feeltrace</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>26996.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>65427.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>87506.5</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>114499.5</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>144872.5</td>
      <td>-1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Also calculating the slope values based on the aggregated feeltrace data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p10_feeltrace_agg_mean_slope</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">mean_feeltrace_words</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">indexes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">p10_feeltrace_agg_mean</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># middle windows</span>
<span class="k">for</span> <span class="p">(</span><span class="n">prev_idx</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indexes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">mean_feeltrace_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">change_direction</span><span class="p">(</span><span class="n">p10_feeltrace_agg_mean</span><span class="o">.</span><span class="n">Feeltrace</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">prev_idx</span><span class="p">:</span><span class="n">idx</span><span class="p">],</span> <span class="n">p10_feeltrace_agg_mean</span><span class="o">.</span><span class="n">Timestamps</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">prev_idx</span><span class="p">:</span><span class="n">idx</span><span class="p">]))</span>

<span class="n">p10_feeltrace_agg_mean_slope</span><span class="p">[</span><span class="s1">&#39;Feeltrace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_feeltrace_words</span>
<span class="n">p10_feeltrace_agg_mean_slope</span><span class="p">[</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timestamps</span>
<span class="n">p10_feeltrace_agg_mean_slope</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Feeltrace</th>
      <th>Timestamps</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>54000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>76866.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>98149.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.0</td>
      <td>130849.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>158899.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Taking the slopes for interview words:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p10_words_agg_slope</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">slope_words</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">indexes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">p10_words</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># middle windows</span>
<span class="k">for</span> <span class="p">(</span><span class="n">prev_idx</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">indexes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">slope_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">change_direction</span><span class="p">(</span><span class="n">p10_words</span><span class="o">.</span><span class="n">Values</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">prev_idx</span><span class="p">:</span><span class="n">idx</span><span class="p">],</span> <span class="n">p10_words</span><span class="o">.</span><span class="n">Timestamps</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">prev_idx</span><span class="p">:</span><span class="n">idx</span><span class="p">]))</span>

<span class="n">p10_words_agg_slope</span><span class="p">[</span><span class="s1">&#39;Values&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">slope_words</span>
<span class="n">p10_words_agg_slope</span><span class="p">[</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timestamps</span>
<span class="n">p10_words_agg_slope</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Values</th>
      <th>Timestamps</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>54000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>76866.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>98149.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.0</td>
      <td>130849.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.0</td>
      <td>158899.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">p10_words</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Values&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">p10_words_agg_slope</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Values&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Original words&#39;</span><span class="p">,</span> <span class="s1">&#39;AggWords&#39;</span><span class="p">]);</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">p10_feeltrace</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Feeltrace&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">p10_feeltrace_agg_slope</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Feeltrace&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Original feeltrace&#39;</span><span class="p">,</span> <span class="s1">&#39;AggSlopeFeeltrace&#39;</span><span class="p">]);</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">p10_feeltrace_agg_mean</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Feeltrace&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">p10_feeltrace_agg_mean_slope</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Feeltrace&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;AggMeanFeeltrace&#39;</span><span class="p">,</span> <span class="s1">&#39;AggMeanSlopeFeeltrace&#39;</span><span class="p">]);</span>

<span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">timestamps</span><span class="p">:</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/words-feeltrace_44_0.png" src="_images/words-feeltrace_44_0.png" />
</div>
</div>
<p>To proceed with analysis, I will be comparing the transitions captured by word labels and by the aggregated feeltrace values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p10_agg_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">p10_agg_data</span><span class="p">[</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p10_words_agg_slope</span><span class="p">[</span><span class="s1">&#39;Timestamps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">p10_agg_data</span><span class="p">[</span><span class="s1">&#39;Words&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p10_words_agg_slope</span><span class="p">[</span><span class="s1">&#39;Values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">p10_agg_data</span><span class="p">[</span><span class="s1">&#39;Feeltrace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p10_feeltrace_agg_mean_slope</span><span class="p">[</span><span class="s1">&#39;Feeltrace&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">p10_agg_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamps</th>
      <th>Words</th>
      <th>Feeltrace</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>54000.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>76866.5</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>98149.5</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>130849.5</td>
      <td>-1.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>158899.5</td>
      <td>-1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Checking autocorelation on aggregated data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">p10_words_agg_slope</span><span class="p">[</span><span class="s1">&#39;Values&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p10_words_agg_slope</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/words-feeltrace_48_0.png" src="_images/words-feeltrace_48_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">p10_feeltrace_agg_mean_slope</span><span class="p">[</span><span class="s1">&#39;Feeltrace&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p10_feeltrace_agg_mean_slope</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/words-feeltrace_49_0.png" src="_images/words-feeltrace_49_0.png" />
</div>
</div>
</div>
<div class="section" id="joint-time-series-analysis">
<h4>Joint time series analysis<a class="headerlink" href="#joint-time-series-analysis" title="Permalink to this headline">¶</a></h4>
<p>The results of Granger Causality for P10 are promising, suggeting a significant relationship* between interview words and feeltrace.</p>
<p>*(potentially a causality relationship, although this might be too strong of a claim, see <code class="docutils literal notranslate"><span class="pre">Limitations</span></code> section below)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">grangercausalitytests</span>
<span class="n">maxlag</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">test</span> <span class="o">=</span> <span class="s1">&#39;ssr_chi2test&#39;</span>

<span class="k">def</span> <span class="nf">grangers_causation_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s1">&#39;ssr_chi2test&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>    
    <span class="sd">&quot;&quot;&quot;Check Granger Causality of all possible combinations of the Time series.</span>
<span class="sd">    The rows are the response variable, columns are predictors. The values in the table </span>
<span class="sd">    are the P-Values. P-Values lesser than the significance level (0.05), implies </span>
<span class="sd">    the Null Hypothesis that the coefficients of the corresponding past values is </span>
<span class="sd">    zero, that is, the X does not cause Y can be rejected.</span>

<span class="sd">    data      : pandas dataframe containing the time series variables</span>
<span class="sd">    variables : list containing names of the time series variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">))),</span> <span class="n">columns</span><span class="o">=</span><span class="n">variables</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">variables</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">test_result</span> <span class="o">=</span> <span class="n">grangercausalitytests</span><span class="p">(</span><span class="n">data</span><span class="p">[[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]],</span> <span class="n">maxlag</span><span class="o">=</span><span class="n">maxlag</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">p_values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">test_result</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">test</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxlag</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Y = </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s1">, X = </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s1">, P Values = </span><span class="si">{</span><span class="n">p_values</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">min_p_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">p_values</span><span class="p">)</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_p_value</span>
    <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="o">+</span> <span class="s1">&#39;_x&#39;</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="o">+</span> <span class="s1">&#39;_y&#39;</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="n">grangers_causation_matrix</span><span class="p">(</span><span class="n">p10_agg_data</span><span class="p">[[</span><span class="s1">&#39;Words&#39;</span><span class="p">,</span> <span class="s1">&#39;Feeltrace&#39;</span><span class="p">]],</span> <span class="n">variables</span> <span class="o">=</span> <span class="n">p10_agg_data</span><span class="p">[[</span><span class="s1">&#39;Words&#39;</span><span class="p">,</span> <span class="s1">&#39;Feeltrace&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 

<span class="c1"># notes: </span>
<span class="c1"># The row are the Response (Y) and the columns are the predictor series (X).</span>

<span class="c1"># For example, if you take the value 0.0021 in (row 1, column 2), it refers to </span>
<span class="c1"># the p-value of Feeltrace_x causing Words_y.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Y = Words, X = Words, P Values = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
Y = Feeltrace, X = Words, P Values = [0.0395, 0.1126, 0.0887, 0.1401, 0.1874, 0.3395, 0.0001, 0.0]
Y = Words, X = Feeltrace, P Values = [0.9161, 0.8378, 0.9315, 0.4438, 0.0869, 0.0579, 0.0188, 0.0021]
Y = Feeltrace, X = Feeltrace, P Values = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Words_x</th>
      <th>Feeltrace_x</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Words_y</th>
      <td>1.0</td>
      <td>0.0021</td>
    </tr>
    <tr>
      <th>Feeltrace_y</th>
      <td>0.0</td>
      <td>1.0000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="limitations">
<h4>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">¶</a></h4>
<p>(see <a class="reference external" href="https://en.wikipedia.org/wiki/Granger_causality#Limitations">https://en.wikipedia.org/wiki/Granger_causality#Limitations</a>)</p>
<p>As its name implies, Granger causality is not necessarily true causality. In fact, the Granger-causality tests fulfill only the Humean definition of causality that identifies the cause-effect relations with constant conjunctions.[14] If both X and Y are driven by a common third process with different lags, one might still fail to reject the alternative hypothesis of Granger causality. Yet, manipulation of one of the variables would not change the other. Indeed, the Granger-causality tests are designed to handle pairs of variables, and may produce misleading results when the true relationship involves three or more variables. Having said this, it has been argued that given a probabilistic view of causation, Granger causality can be considered true causality in that sense, especially when Reichenbach’s “screening off” notion of probabilistic causation is taken into account.[15] Other possible sources of misguiding test results are: (1) not frequent enough or too frequent sampling, (2) nonlinear causal relationship, (3) time series nonstationarity and nonlinearity and (4) existence of rational expectations.[14] A similar test involving more variables can be applied with vector autoregression. Recently [16] a fundamental mathematical study of the mechanism underlying the Granger method has been provided. By making use exclusively of mathematical tools (Fourier transformation and differential calculus), it has been found that not even the most basic requirement underlying any possible definition of causality is met by the Granger causality test: any definition of causality should refer to the prediction of the future from the past; instead by inverting the time series it can be shown that Granger allows one to ”predict” the past from the future as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#-----------------------------------------</span>
<span class="c1"># cointegration</span>
<span class="c1">#-----------------------------------------</span>

<span class="c1"># When two or more time series are cointegrated, it means they have a long run, </span>
<span class="c1"># statistically significant relationship.</span>

<span class="c1"># This is the basic premise on which Vector Autoregression(VAR) models is based on. </span>
<span class="c1"># So, it’s fairly common to implement the cointegration test before starting to </span>
<span class="c1"># build VAR models.</span>

<span class="c1"># more technically:</span>
<span class="c1"># Order of integration(d) is nothing but the number of differencing required to </span>
<span class="c1"># make a non-stationary time series stationary.</span>

<span class="c1"># Now, when you have two or more time series, and there exists a linear combination</span>
<span class="c1">#  of them that has an order of integration (d) less than that of the individual </span>
<span class="c1"># series, then the collection of series is said to be cointegrated.</span>

<span class="kn">from</span> <span class="nn">statsmodels.tsa.vector_ar.vecm</span> <span class="kn">import</span> <span class="n">coint_johansen</span>

<span class="k">def</span> <span class="nf">cointegration_test</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot;Perform Johanson&#39;s Cointegration Test and Report Summary&quot;&quot;&quot;</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">coint_johansen</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;0.90&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;0.95&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;0.99&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
    <span class="n">traces</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">lr1</span>
    <span class="n">cvts</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">cvt</span><span class="p">[:,</span> <span class="n">d</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)]]</span>
    <span class="k">def</span> <span class="nf">adjust</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span> <span class="mi">6</span><span class="p">):</span> <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>

    <span class="c1"># Summary</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Name   ::  Test Stat &gt; C(95%)    =&gt;   Signif  </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">trace</span><span class="p">,</span> <span class="n">cvt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">traces</span><span class="p">,</span> <span class="n">cvts</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">adjust</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="s1">&#39;:: &#39;</span><span class="p">,</span> <span class="n">adjust</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="mi">9</span><span class="p">),</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="n">adjust</span><span class="p">(</span><span class="n">cvt</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="s1">&#39; =&gt;  &#39;</span> <span class="p">,</span> <span class="n">trace</span> <span class="o">&gt;</span> <span class="n">cvt</span><span class="p">)</span>

<span class="n">cointegration_test</span><span class="p">(</span><span class="n">p10_agg_data</span><span class="p">[[</span><span class="s1">&#39;Words&#39;</span><span class="p">,</span> <span class="s1">&#39;Feeltrace&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name   ::  Test Stat &gt; C(95%)    =&gt;   Signif  
 ----------------------------------------
Words  ::  25.09     &gt; 12.3212   =&gt;   True
Feeltrace ::  5.58      &gt; 4.1296    =&gt;   True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span>

<span class="c1">#------------------------------</span>
<span class="c1"># check for stationarity</span>
<span class="c1">#-----------------------------</span>

<span class="c1"># VAR model requires the time series you want to forecast to be stationary, </span>
<span class="c1"># it is customary to check all the time series in the system for stationarity.</span>

<span class="c1"># Since, differencing reduces the length of the series by 1 and since all the </span>
<span class="c1"># time series has to be of the same length, you need to difference all the series</span>
<span class="c1">#  in the system if you choose to difference at all.</span>

<span class="k">def</span> <span class="nf">adfuller_test</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">signif</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform ADFuller to test for Stationarity of given series and print report&quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">autolag</span><span class="o">=</span><span class="s1">&#39;AIC&#39;</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;test_statistic&#39;</span><span class="p">:</span><span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;pvalue&#39;</span><span class="p">:</span><span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;n_lags&#39;</span><span class="p">:</span><span class="nb">round</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;n_obs&#39;</span><span class="p">:</span><span class="n">r</span><span class="p">[</span><span class="mi">3</span><span class="p">]}</span>
    <span class="n">p_value</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="s1">&#39;pvalue&#39;</span><span class="p">]</span> 
    <span class="k">def</span> <span class="nf">adjust</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span> <span class="mi">6</span><span class="p">):</span> <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>

    <span class="c1"># Print Summary</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;    Augmented Dickey-Fuller Test on &quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   &quot;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">47</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; Null Hypothesis: Data has unit root. Non-Stationary.&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; Significance Level    = </span><span class="si">{</span><span class="n">signif</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; Test Statistic        = </span><span class="si">{</span><span class="n">output</span><span class="p">[</span><span class="s2">&quot;test_statistic&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; No. Lags Chosen       = </span><span class="si">{</span><span class="n">output</span><span class="p">[</span><span class="s2">&quot;n_lags&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; Critical value </span><span class="si">{</span><span class="n">adjust</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;=</span> <span class="n">signif</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; =&gt; P-Value = </span><span class="si">{</span><span class="n">p_value</span><span class="si">}</span><span class="s2">. Rejecting Null Hypothesis.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; =&gt; Series is Stationary.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; =&gt; P-Value = </span><span class="si">{</span><span class="n">p_value</span><span class="si">}</span><span class="s2">. Weak evidence to reject the Null Hypothesis.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; =&gt; Series is Non-Stationary.&quot;</span><span class="p">)</span>  
        
 <span class="c1"># ADF Test on each column</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">p10_agg_data</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
    <span class="k">if</span> <span class="s1">&#39;Timestamps&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">adfuller_test</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">column</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>       
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Augmented Dickey-Fuller Test on &quot;Words&quot; 
    -----------------------------------------------
 Null Hypothesis: Data has unit root. Non-Stationary.
 Significance Level    = 0.05
 Test Statistic        = -6.6022
 No. Lags Chosen       = 0
 Critical value 1%     = -3.679
 Critical value 5%     = -2.968
 Critical value 10%    = -2.623
 =&gt; P-Value = 0.0. Rejecting Null Hypothesis.
 =&gt; Series is Stationary.


    Augmented Dickey-Fuller Test on &quot;Feeltrace&quot; 
    -----------------------------------------------
 Null Hypothesis: Data has unit root. Non-Stationary.
 Significance Level    = 0.05
 Test Statistic        = -2.5379
 No. Lags Chosen       = 5
 Critical value 1%     = -3.738
 Critical value 5%     = -2.992
 Critical value 10%    = -2.636
 =&gt; P-Value = 0.1065. Weak evidence to reject the Null Hypothesis.
 =&gt; Series is Non-Stationary.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p10_agg_data</span><span class="p">[[</span><span class="s1">&#39;Words&#39;</span><span class="p">,</span> <span class="s1">&#39;Feeltrace&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Words</th>
      <th>Feeltrace</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Words</th>
      <td>1.000000</td>
      <td>0.365165</td>
    </tr>
    <tr>
      <th>Feeltrace</th>
      <td>0.365165</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="emotion-dynamics-analysis">
<h2>Emotion dynamics analysis<a class="headerlink" href="#emotion-dynamics-analysis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="defining-emotion-dynamics-features">
<h3>Defining emotion dynamics features<a class="headerlink" href="#defining-emotion-dynamics-features" title="Permalink to this headline">¶</a></h3>
<p>Refer to <em>Houben M, Van Den Noortgate W, Kuppens P. The relation between short-term emotion dynamics and psychological well-being: A meta-analysis. Psychological bulletin. 2015 Jul;141(4):901.</em></p>
<ul class="simple">
<li><p><strong>Emotional inertia:</strong> refers to how well the intensity of an emotional state can be predicted from the emotional state at a previous moment.</p></li>
<li><p><strong>Emotional instability:</strong> refers to the magnitude of emotional changes from one moment to the next. An individual characterized by high levels of instability experiences larger emotional shifts from one moment to the next, resulting in a more unstable emotional life.</p></li>
<li><p><strong>Emotional variability:</strong> refers to the range or amplitude of someone’s emotional states across time. An individual characterized by higher levels of emotional variability experiences emotions that reach more extreme levels and shows larger emotional deviations from his or her average emotional level</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">EmotionDynamics</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Fs</span><span class="o">*</span><span class="n">interval</span><span class="o">*</span><span class="mf">1e-1</span><span class="p">)</span> <span class="c1"># feeltrace sampling rate x 300 ms</span>

    <span class="k">def</span> <span class="nf">emotional_variability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">emotional_instability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">X</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># MSSD</span>

    <span class="k">def</span> <span class="nf">emotional_inertia</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">lag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">lag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lag</span>
        <span class="k">return</span> <span class="n">stattools</span><span class="o">.</span><span class="n">acf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">nlags</span><span class="o">=</span><span class="n">lag</span><span class="p">)[</span><span class="n">lag</span><span class="p">]</span> <span class="c1"># Autocorrelation</span>
    
    <span class="k">def</span> <span class="nf">get_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Inertia&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Instability&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Variability&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Inertia&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">emotional_inertia</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Instability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">emotional_instability</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;Variability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">emotional_variability</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">parameters</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ED</span> <span class="o">=</span> <span class="n">EmotionDynamics</span><span class="p">(</span><span class="n">Fs</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">ED</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">(</span><span class="n">p10_words</span><span class="p">[</span><span class="s1">&#39;Values&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Inertia&#39;: -0.058245294276545984,
 &#39;Instability&#39;: 0.11847916666666665,
 &#39;Variability&#39;: 0.23778154351203037}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">words_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">words_list</span><span class="p">:</span>
    <span class="n">calibrated_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">subject</span><span class="p">[</span><span class="s1">&#39;Values&#39;</span><span class="p">])</span>
    <span class="n">ed</span> <span class="o">=</span> <span class="n">ED</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">(</span><span class="n">calibrated_values</span><span class="p">)</span>
    <span class="n">ed</span><span class="p">[</span><span class="s1">&#39;p_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject</span><span class="p">[</span><span class="s1">&#39;p_number&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ed</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;interview&#39;</span>
    <span class="n">words_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ed</span><span class="p">)</span>
<span class="n">words_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">words_data</span><span class="p">)</span>
<span class="n">words_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Inertia</th>
      <th>Instability</th>
      <th>Variability</th>
      <th>p_number</th>
      <th>pass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.058245</td>
      <td>4739.166667</td>
      <td>47.556309</td>
      <td>p10</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.037667</td>
      <td>4309.883721</td>
      <td>45.126086</td>
      <td>p12</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.042847</td>
      <td>4868.750000</td>
      <td>49.910073</td>
      <td>p13</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.182514</td>
      <td>2575.000000</td>
      <td>33.046305</td>
      <td>p15</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.240929</td>
      <td>2970.967742</td>
      <td>43.546121</td>
      <td>p17</td>
      <td>interview</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ED</span> <span class="o">=</span> <span class="n">EmotionDynamics</span><span class="p">(</span><span class="n">Fs</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">feeltrace_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">subject</span> <span class="ow">in</span> <span class="n">feeltrace_list</span><span class="p">:</span>
    <span class="n">feeltrace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">subject</span><span class="p">[</span><span class="s1">&#39;Feeltrace&#39;</span><span class="p">])</span>
    <span class="n">ed</span> <span class="o">=</span> <span class="n">ED</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">(</span><span class="n">feeltrace</span><span class="p">)</span>
    <span class="n">ed</span><span class="p">[</span><span class="s1">&#39;p_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject</span><span class="p">[</span><span class="s1">&#39;p_number&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ed</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;feeltrace&#39;</span>
    <span class="n">feeltrace_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ed</span><span class="p">)</span>
    
<span class="n">feeltrace_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">feeltrace_data</span><span class="p">)</span>
<span class="n">feeltrace_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Inertia</th>
      <th>Instability</th>
      <th>Variability</th>
      <th>p_number</th>
      <th>pass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.017359</td>
      <td>0.593234</td>
      <td>32.349176</td>
      <td>p10</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.127506</td>
      <td>1.278632</td>
      <td>49.077727</td>
      <td>p12</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.111697</td>
      <td>0.951712</td>
      <td>38.263004</td>
      <td>p13</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.087622</td>
      <td>1.989445</td>
      <td>40.816129</td>
      <td>p15</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.005488</td>
      <td>0.761333</td>
      <td>42.022961</td>
      <td>p17</td>
      <td>feeltrace</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">words_data</span><span class="p">,</span> <span class="n">feeltrace_data</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Inertia</th>
      <th>Instability</th>
      <th>Variability</th>
      <th>p_number</th>
      <th>pass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.058245</td>
      <td>4739.166667</td>
      <td>47.556309</td>
      <td>p10</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.037667</td>
      <td>4309.883721</td>
      <td>45.126086</td>
      <td>p12</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.042847</td>
      <td>4868.750000</td>
      <td>49.910073</td>
      <td>p13</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.182514</td>
      <td>2575.000000</td>
      <td>33.046305</td>
      <td>p15</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.240929</td>
      <td>2970.967742</td>
      <td>43.546121</td>
      <td>p17</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.205085</td>
      <td>2337.096774</td>
      <td>38.247434</td>
      <td>p19</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.079935</td>
      <td>2387.777778</td>
      <td>36.376685</td>
      <td>p2</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-0.060902</td>
      <td>3267.307692</td>
      <td>39.285613</td>
      <td>p20</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-0.079603</td>
      <td>2957.500000</td>
      <td>37.608064</td>
      <td>p22</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.009257</td>
      <td>3268.243243</td>
      <td>40.209157</td>
      <td>p23</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-0.032880</td>
      <td>3156.875000</td>
      <td>38.628326</td>
      <td>p4</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>11</th>
      <td>-0.202814</td>
      <td>5553.260870</td>
      <td>47.484921</td>
      <td>p5</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>12</th>
      <td>-0.005982</td>
      <td>2858.333333</td>
      <td>37.872801</td>
      <td>p6</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>13</th>
      <td>-0.091160</td>
      <td>5023.076923</td>
      <td>47.378793</td>
      <td>p7</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.077677</td>
      <td>1895.714286</td>
      <td>32.055062</td>
      <td>p8</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>15</th>
      <td>-0.221163</td>
      <td>4615.425532</td>
      <td>43.078049</td>
      <td>p9</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.017359</td>
      <td>0.593234</td>
      <td>32.349176</td>
      <td>p10</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.127506</td>
      <td>1.278632</td>
      <td>49.077727</td>
      <td>p12</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.111697</td>
      <td>0.951712</td>
      <td>38.263004</td>
      <td>p13</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.087622</td>
      <td>1.989445</td>
      <td>40.816129</td>
      <td>p15</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-0.005488</td>
      <td>0.761333</td>
      <td>42.022961</td>
      <td>p17</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0.012039</td>
      <td>1.315396</td>
      <td>39.632455</td>
      <td>p19</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>22</th>
      <td>0.067442</td>
      <td>0.714600</td>
      <td>39.557379</td>
      <td>p2</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0.288932</td>
      <td>0.922316</td>
      <td>33.193777</td>
      <td>p20</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>24</th>
      <td>-0.136392</td>
      <td>1.056519</td>
      <td>38.449633</td>
      <td>p22</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0.156959</td>
      <td>0.808034</td>
      <td>29.005620</td>
      <td>p23</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>26</th>
      <td>0.231364</td>
      <td>0.985158</td>
      <td>48.939746</td>
      <td>p4</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>27</th>
      <td>-0.069199</td>
      <td>0.952268</td>
      <td>29.056105</td>
      <td>p5</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0.529267</td>
      <td>1.015773</td>
      <td>48.688655</td>
      <td>p6</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>29</th>
      <td>-0.058015</td>
      <td>0.796932</td>
      <td>42.722726</td>
      <td>p7</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0.081231</td>
      <td>0.784511</td>
      <td>43.330018</td>
      <td>p8</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>31</th>
      <td>0.135203</td>
      <td>0.501430</td>
      <td>27.154791</td>
      <td>p9</td>
      <td>feeltrace</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="data-preprocessing-scaling">
<h3>Data preprocessing: scaling<a class="headerlink" href="#data-preprocessing-scaling" title="Permalink to this headline">¶</a></h3>
<p>Standardize features by removing the mean and scaling to unit variance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_feeltrace</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">feeltrace_data</span><span class="p">[[</span><span class="s1">&#39;Inertia&#39;</span><span class="p">,</span> <span class="s1">&#39;Instability&#39;</span><span class="p">,</span> <span class="s1">&#39;Variability&#39;</span><span class="p">]])</span>
<span class="n">X_feeltrace</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_feeltrace</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Inertia&#39;</span><span class="p">,</span> <span class="s1">&#39;Instability&#39;</span><span class="p">,</span> <span class="s1">&#39;Variability&#39;</span><span class="p">])</span>
<span class="n">X_feeltrace</span><span class="p">[</span><span class="s1">&#39;p_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">feeltrace_data</span><span class="p">[</span><span class="s1">&#39;p_number&#39;</span><span class="p">]</span>
<span class="n">X_feeltrace</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">feeltrace_data</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">]</span>
<span class="n">X_feeltrace</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Inertia</th>
      <th>Instability</th>
      <th>Variability</th>
      <th>p_number</th>
      <th>pass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.527612</td>
      <td>-1.097853</td>
      <td>-0.950685</td>
      <td>p10</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.187769</td>
      <td>0.930514</td>
      <td>1.480287</td>
      <td>p12</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.085095</td>
      <td>-0.036975</td>
      <td>-0.091295</td>
      <td>p13</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.071268</td>
      <td>3.034094</td>
      <td>0.279722</td>
      <td>p15</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.675998</td>
      <td>-0.600382</td>
      <td>0.455097</td>
      <td>p17</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.562169</td>
      <td>1.039313</td>
      <td>0.107712</td>
      <td>p19</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-0.202338</td>
      <td>-0.738683</td>
      <td>0.096802</td>
      <td>p2</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.236198</td>
      <td>-0.123969</td>
      <td>-0.827949</td>
      <td>p20</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-1.526199</td>
      <td>0.273190</td>
      <td>-0.064174</td>
      <td>p22</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.379056</td>
      <td>-0.462175</td>
      <td>-1.436566</td>
      <td>p23</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.862305</td>
      <td>0.062007</td>
      <td>1.460235</td>
      <td>p4</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>11</th>
      <td>-1.089790</td>
      <td>-0.035328</td>
      <td>-1.429230</td>
      <td>p5</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2.797121</td>
      <td>0.152608</td>
      <td>1.423747</td>
      <td>p6</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>13</th>
      <td>-1.017152</td>
      <td>-0.495032</td>
      <td>0.556786</td>
      <td>p7</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>14</th>
      <td>-0.112779</td>
      <td>-0.531789</td>
      <td>0.645037</td>
      <td>p8</td>
      <td>feeltrace</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.237761</td>
      <td>-1.369540</td>
      <td>-1.705526</td>
      <td>p9</td>
      <td>feeltrace</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_words</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">words_data</span><span class="p">[[</span><span class="s1">&#39;Inertia&#39;</span><span class="p">,</span> <span class="s1">&#39;Instability&#39;</span><span class="p">,</span> <span class="s1">&#39;Variability&#39;</span><span class="p">]])</span>
<span class="n">X_words</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_words</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Inertia&#39;</span><span class="p">,</span> <span class="s1">&#39;Instability&#39;</span><span class="p">,</span> <span class="s1">&#39;Variability&#39;</span><span class="p">])</span>
<span class="n">X_words</span><span class="p">[</span><span class="s1">&#39;p_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">words_data</span><span class="p">[</span><span class="s1">&#39;p_number&#39;</span><span class="p">]</span>
<span class="n">X_words</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">words_data</span><span class="p">[</span><span class="s1">&#39;pass&#39;</span><span class="p">]</span>
<span class="n">X_words</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Inertia</th>
      <th>Instability</th>
      <th>Variability</th>
      <th>p_number</th>
      <th>pass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.303855</td>
      <td>1.091102</td>
      <td>1.239767</td>
      <td>p10</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.141110</td>
      <td>0.697543</td>
      <td>0.773963</td>
      <td>p12</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.495656</td>
      <td>1.209901</td>
      <td>1.690916</td>
      <td>p13</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.286661</td>
      <td>-0.892967</td>
      <td>-1.541383</td>
      <td>p15</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.062228</td>
      <td>-0.529951</td>
      <td>0.471130</td>
      <td>p17</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.778744</td>
      <td>-1.111073</td>
      <td>-0.544476</td>
      <td>p19</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.788972</td>
      <td>-1.064609</td>
      <td>-0.903045</td>
      <td>p2</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-0.324868</td>
      <td>-0.258272</td>
      <td>-0.345487</td>
      <td>p20</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-0.472769</td>
      <td>-0.542298</td>
      <td>-0.667025</td>
      <td>p22</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.230004</td>
      <td>-0.257414</td>
      <td>-0.168470</td>
      <td>p23</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-0.103245</td>
      <td>-0.359515</td>
      <td>-0.471470</td>
      <td>p4</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>11</th>
      <td>-1.447203</td>
      <td>1.837448</td>
      <td>1.226084</td>
      <td>p5</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.109482</td>
      <td>-0.633212</td>
      <td>-0.616283</td>
      <td>p6</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>13</th>
      <td>-0.564167</td>
      <td>1.351385</td>
      <td>1.205742</td>
      <td>p7</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.771117</td>
      <td>-1.515724</td>
      <td>-1.731376</td>
      <td>p8</td>
      <td>interview</td>
    </tr>
    <tr>
      <th>15</th>
      <td>-1.592325</td>
      <td>0.977658</td>
      <td>0.381414</td>
      <td>p9</td>
      <td>interview</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_words</span><span class="p">,</span> <span class="n">X_feeltrace</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="pairplot-analysis">
<h3>Pairplot analysis<a class="headerlink" href="#pairplot-analysis" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/words-feeltrace_70_0.png" src="_images/words-feeltrace_70_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">abs</span><span class="p">(</span><span class="n">X_feeltrace</span><span class="p">[[</span><span class="s1">&#39;Inertia&#39;</span><span class="p">,</span> <span class="s1">&#39;Instability&#39;</span><span class="p">,</span> <span class="s1">&#39;Variability&#39;</span><span class="p">]]</span> <span class="o">-</span> <span class="n">X_words</span><span class="p">[[</span><span class="s1">&#39;Inertia&#39;</span><span class="p">,</span> <span class="s1">&#39;Instability&#39;</span><span class="p">,</span> <span class="s1">&#39;Variability&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Inertia</th>
      <th>Instability</th>
      <th>Variability</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.223757</td>
      <td>2.188955</td>
      <td>2.190452</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.328879</td>
      <td>0.232971</td>
      <td>0.706323</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.410561</td>
      <td>1.246877</td>
      <td>1.782211</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.215394</td>
      <td>3.927061</td>
      <td>1.821105</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.738226</td>
      <td>0.070431</td>
      <td>0.016032</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.340913</td>
      <td>2.150386</td>
      <td>0.652188</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.991310</td>
      <td>0.325926</td>
      <td>0.999847</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.561066</td>
      <td>0.134303</td>
      <td>0.482461</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.053430</td>
      <td>0.815489</td>
      <td>0.602851</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.149052</td>
      <td>0.204760</td>
      <td>1.268096</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.965550</td>
      <td>0.421522</td>
      <td>1.931706</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.357413</td>
      <td>1.872777</td>
      <td>2.655314</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2.687639</td>
      <td>0.785820</td>
      <td>2.040030</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.452986</td>
      <td>1.846417</td>
      <td>0.648956</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.883896</td>
      <td>0.983935</td>
      <td>2.376413</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1.830086</td>
      <td>2.347198</td>
      <td>2.086940</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="d-scatterplot">
<h3>3D scatterplot<a class="headerlink" href="#d-scatterplot" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">elev</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="mi">130</span><span class="p">,</span> <span class="n">auto_add_to_figure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_scaled</span><span class="o">.</span><span class="n">Inertia</span><span class="p">,</span> <span class="n">X_scaled</span><span class="o">.</span><span class="n">Instability</span><span class="p">,</span> <span class="n">X_scaled</span><span class="o">.</span><span class="n">Variability</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">nipy_spectral</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">subject</span><span class="p">)</span> <span class="ow">in</span> <span class="n">X_scaled</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span> <span class="c1">#plot each point + it&#39;s index as text above</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">subject</span><span class="p">[</span><span class="s1">&#39;p_number&#39;</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">subject</span><span class="o">.</span><span class="n">Inertia</span><span class="p">,</span><span class="n">subject</span><span class="o">.</span><span class="n">Instability</span><span class="p">,</span> <span class="n">subject</span><span class="o">.</span><span class="n">Variability</span><span class="p">,</span>  <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">label</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span> 

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Inertia&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Instability&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Variability&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/words-feeltrace_73_0.png" src="_images/words-feeltrace_73_0.png" />
</div>
</div>
</div>
<div class="section" id="principal-component-analysis">
<h3>Principal Component Analysis<a class="headerlink" href="#principal-component-analysis" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">decomposition</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">[[</span><span class="s1">&#39;Inertia&#39;</span><span class="p">,</span> <span class="s1">&#39;Instability&#39;</span><span class="p">,</span> <span class="s1">&#39;Variability&#39;</span><span class="p">]])</span>
<span class="n">X_PCA</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">[[</span><span class="s1">&#39;Inertia&#39;</span><span class="p">,</span> <span class="s1">&#39;Instability&#39;</span><span class="p">,</span> <span class="s1">&#39;Variability&#39;</span><span class="p">]])</span>

<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_PCA</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">X_PCA</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]);</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">subject</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X_scaled</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()):</span> <span class="c1">#plot each point + it&#39;s index as text above</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">subject</span><span class="p">[</span><span class="s1">&#39;p_number&#39;</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">X_PCA</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_PCA</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">label</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/words-feeltrace_75_0.png" src="_images/words-feeltrace_75_0.png" />
</div>
</div>
</div>
<div class="section" id="gaussian-mixture-model">
<h3>Gaussian Mixture Model<a class="headerlink" href="#gaussian-mixture-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">================================</span>
<span class="sd">Gaussian Mixture Model Selection</span>
<span class="sd">================================</span>

<span class="sd">Gaussian Mixture Models using information-theoretic criteria (BIC).</span>
<span class="sd">Model selection concerns both the covariance type and the number of components in the model.</span>
<span class="sd">Unlike Bayesian procedures, such inferences are prior-free.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">itertools</span>

<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">mixture</span>

<span class="n">lowest_bic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">infty</span>
<span class="n">bic</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">n_components_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">cv_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;spherical&quot;</span><span class="p">,</span> <span class="s2">&quot;tied&quot;</span><span class="p">,</span> <span class="s2">&quot;diag&quot;</span><span class="p">,</span> <span class="s2">&quot;full&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">cv_type</span> <span class="ow">in</span> <span class="n">cv_types</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">n_components</span> <span class="ow">in</span> <span class="n">n_components_range</span><span class="p">:</span>
        <span class="c1"># Fit a Gaussian mixture with EM</span>
        <span class="n">gmm</span> <span class="o">=</span> <span class="n">mixture</span><span class="o">.</span><span class="n">GaussianMixture</span><span class="p">(</span>
            <span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">,</span> <span class="n">covariance_type</span><span class="o">=</span><span class="n">cv_type</span>
        <span class="p">)</span>
        <span class="n">gmm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">[[</span><span class="s1">&#39;Inertia&#39;</span><span class="p">,</span> <span class="s1">&#39;Instability&#39;</span><span class="p">,</span> <span class="s1">&#39;Variability&#39;</span><span class="p">]])</span>
        <span class="n">bic</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gmm</span><span class="o">.</span><span class="n">bic</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">[[</span><span class="s1">&#39;Inertia&#39;</span><span class="p">,</span> <span class="s1">&#39;Instability&#39;</span><span class="p">,</span> <span class="s1">&#39;Variability&#39;</span><span class="p">]]))</span>
        <span class="k">if</span> <span class="n">bic</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lowest_bic</span><span class="p">:</span>
            <span class="n">lowest_bic</span> <span class="o">=</span> <span class="n">bic</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">best_gmm</span> <span class="o">=</span> <span class="n">gmm</span>

<span class="n">bic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bic</span><span class="p">)</span>
<span class="n">color_iter</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">cycle</span><span class="p">([</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:green&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:purple&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:brown&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:pink&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:gray&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:olive&#39;</span><span class="p">,</span> <span class="s1">&#39;tab:cyan&#39;</span><span class="p">])</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">best_gmm</span>
<span class="n">bars</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Plot the BIC scores</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">spl</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">cv_type</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">cv_types</span><span class="p">,</span> <span class="n">color_iter</span><span class="p">)):</span>
    <span class="n">xpos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">n_components_range</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">bars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
            <span class="n">xpos</span><span class="p">,</span>
            <span class="n">bic</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">n_components_range</span><span class="p">)</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">n_components_range</span><span class="p">)],</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">n_components_range</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="n">bic</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1.01</span> <span class="o">-</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">bic</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">bic</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;BIC score per model&quot;</span><span class="p">)</span>
<span class="n">xpos</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">bic</span><span class="o">.</span><span class="n">argmin</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="n">n_components_range</span><span class="p">))</span>
    <span class="o">+</span> <span class="mf">0.65</span>
    <span class="o">+</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">bic</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">n_components_range</span><span class="p">))</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xpos</span><span class="p">,</span> <span class="n">bic</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.97</span> <span class="o">+</span> <span class="mf">0.03</span> <span class="o">*</span> <span class="n">bic</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">spl</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Number of components&quot;</span><span class="p">)</span>
<span class="n">spl</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bars</span><span class="p">],</span> <span class="n">cv_types</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/words-feeltrace_77_0.png" src="_images/words-feeltrace_77_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the winner</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">elev</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="mi">130</span><span class="p">,</span> <span class="n">auto_add_to_figure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">Y_</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">[[</span><span class="s1">&#39;Inertia&#39;</span><span class="p">,</span> <span class="s1">&#39;Instability&#39;</span><span class="p">,</span> <span class="s1">&#39;Variability&#39;</span><span class="p">]])</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">means_</span><span class="p">,</span> <span class="n">color_iter</span><span class="p">)):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">Y_</span> <span class="o">==</span> <span class="n">i</span><span class="p">):</span>
        <span class="k">continue</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_scaled</span><span class="o">.</span><span class="n">Inertia</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Y_</span> <span class="o">==</span> <span class="n">i</span><span class="p">],</span> <span class="n">X_scaled</span><span class="o">.</span><span class="n">Instability</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Y_</span> <span class="o">==</span> <span class="n">i</span><span class="p">],</span> 
               <span class="n">X_scaled</span><span class="o">.</span><span class="n">Variability</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Y_</span> <span class="o">==</span> <span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">subject</span><span class="p">)</span> <span class="ow">in</span> <span class="n">X_scaled</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span> <span class="c1">#plot each point + it&#39;s index as text above</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">subject</span><span class="p">[</span><span class="s1">&#39;p_number&#39;</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">subject</span><span class="o">.</span><span class="n">Inertia</span><span class="p">,</span><span class="n">subject</span><span class="o">.</span><span class="n">Instability</span><span class="p">,</span> <span class="n">subject</span><span class="o">.</span><span class="n">Variability</span><span class="p">,</span>  <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">label</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span> 
    
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">means_</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Inertia&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Instability&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Variability&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Selected GMM: </span><span class="si">{</span><span class="n">best_gmm</span><span class="o">.</span><span class="n">covariance_type</span><span class="si">}</span><span class="s2"> model, &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">best_gmm</span><span class="o">.</span><span class="n">n_components</span><span class="si">}</span><span class="s2"> components&quot;</span>
<span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/words-feeltrace_78_0.png" src="_images/words-feeltrace_78_0.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="calibrated-words.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Calibrated words self-report analysis</p>
            </div>
        </a>
    </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Rubia Guerra<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>